<html>
  <head>
    <meta charset="UTF-8" />
    <title>V4.js</title>
  </head>
  <body>
    <script src="https://cdn.jsdelivr.net/npm/opentype.js@latest/dist/opentype.min.js"></script>
    <script src="./V4.js"></script>
    <canvas id="testCanvas"></canvas>

    <script>
      async function start() {
        var canvas = document.getElementById("testCanvas");
        canvas.height = 500;
        canvas.width = 700;

        var loop = new V4.Loop(canvas, false);
        loop.backgroundColor("#fff");

        var fontObj = new V4.FontGroup();
       //  var fontObj2 = new V4.FontGroup();
        // await fontObj.loadFont(
        //     "assets/CrimsonText-Regular.ttf",
        //     "Regular"
        // );

        await fontObj.loadGFonts("Source Sans Pro", ["Regular", "Italic"]);

        // await fontObj2.loadGFonts("Source Sans Pro", ["Regular"]);

        var font = fontObj.getFontVariant("Italic");
       // var font = fontObj2.getFontVariant("Regular");

        // var textBox = new V4.TextBox(font, 10, 300, 200, 150);
        // textBox.text("Hello, World!", 72);
        // textBox.outlinePath(true);
        // textBox.verticalAlign("CENTER");
        // textBox.horizontalAlign("CENTER");
        // animator.addToAnimation(textBox.renderer);

        var textBox2 = new V4.TextBox({
          font: font,
          position: { x: 0, y: 300 },
          size: { h: 300, w: 700 },
          verticalAlign: "CENTER",
          horizontalAlign: "CENTER",
          fontSize: 72,
          wrap: false
        });

        textBox2.text("Hello, world!");
        textBox2.outlinePath(true);


        var rq = new V4.RenderQueue();

        function colorLoop() {
          var anim5 = new V4.Animation(textBox2, {
            color: "red",
            backgroundColor: "blue",
          });

          rq.push(anim5.renderer, () => {
            var anim6 = new V4.Animation(textBox2, {
              color: "yellow",
              backgroundColor: "black",
            });

            rq.push(anim6.renderer, () => {
              colorLoop();
            });
          });
        }

        function fontSizeLoop() {
          var anim = new V4.Animation(textBox2, { fontSize: 72 });

          rq.push(anim.renderer, () => {
            var anim2 = new V4.Animation(textBox2, { fontSize: 24 });

            rq.push(anim2.renderer, () => {
              fontSizeLoop();
            });
          });
        }

        function positionLoop() {
          var anim3 = new V4.Animation(
            textBox2,
            {
              position: { x: 300, y: 450 },
              size: { h: 250, w: 300 },
            
            },
            6,
            "easeInOutCubic",
          );

          rq.push(anim3.renderer, () => {
            var anim4 = new V4.Animation(
              textBox2,
              {
                position: { x: 0, y: 300 },
                size: { h: 300, w: 700 },
          
              },
              2,
              "easeInOutQuart",
            );
            rq.push(anim4.renderer, () => {
              positionLoop();
            });
          });
        }

        // rq.push(anim3.renderer, () => {
        //     var anim4 = new V4.Animation(textBox2, {position: {x: 0, y: 250}});
        //     rq.push(anim4.renderer, () => {

        //     })
        // })

        loop.addToLoop(rq);

        // fontSizeLoop();
        positionLoop();
        colorLoop();

        // var paths = font.getPaths("Hello, world!", 50, 250, 172);
        // var paths2 = font2.getPaths("Hello, world!",50, 250, 172);

        // const interps = []

        // for (let i = 0; i < paths.length; i++) {
        //   const path1 = paths[i].toPathData(2);
        //   const path2 = paths2[i].toPathData(2);

        //    if (path1.length > 0 && path2.length > 0){
        //     const interp = polymorph.interpolate([

        //  path1,
        //   path2], {
        //     addPoints: 20,
        //     precision: 3
        //   }
        // );
        //   interps.push(interp);
        //    }
          
            

        // }
      
        
//         var duration = 2;
//         var percentDone = 0;
//         function textTestRenderer(state) {
//           const ctx = state.context;
//            ctx.fillStyle = "#000";
//           if (percentDone < 1) {

//             for (const interp of interps) {

// const drawPath = new Path2D(interp(percentDone));
         
//           ctx.fill(drawPath);
//             }






            
//         } else {
//           percentDone = 0;
//         }
          

//           percentDone += state.deltaTime / duration
//         }

//         loop.addToLoop(textTestRenderer);

        // function customRenderer(state) {

        //     // var ctx = state.context;
        //     // elapsed += state.deltaTime;
        //     // if (elapsed > 2) textBox2.text("Two seconds elapsed!", 24)
        //   // textBox2.bounds(bounds.x1 += 10 * state.deltaTime, bounds.y1, bounds.h, bounds.w)

        //     anim.move(state, () => {
        //        anim2.move(state, () => {

        //        })
        //     })
        //    // textBox2.renderer(state);

        // }

        //animator.addToAnimation(textBox2.renderer);
        loop.framesPerSecond(60);
        // var x = 0;
        // var right = true;
        // var speed = 20;

        // function backgroundRenderer(state) {
        //     right
        //         ? (x += speed * state.deltaTime)
        //         : (x -= speed * state.deltaTime);

        //     if (x + 100 > state.canvas.width) {
        //         right = false;
        //     } else if (x - 100 <= 0) {
        //         right = true;
        //     }

        //     state.context.fillStyle = "#000";
        //     state.context.fillRect(x, 20, 100, 200);
        //     //state.context.fillColor();

        //     //   let path = font.getPath("Hello, World!", x, 150, 72);
        //     // path.fill = "white";
        //     //  path.draw(animator.context);
        // }

        // animator.addToAnimation(backgroundRenderer);

        loop.startLoop();
      };

      start();
    </script>
  </body>
</html>
