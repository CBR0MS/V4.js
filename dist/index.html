<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8" />
        <title>V4.js</title>
    </head>
    <body>
        <script src="https://cdn.jsdelivr.net/npm/opentype.js@latest/dist/opentype.min.js"></script>
        <script src="./V4.js"></script>
        <canvas id="testCanvas"></canvas>

        <script>
            var start = async function() {
                var canvas = document.getElementById("testCanvas");
                var animator = new V4.Animator(canvas, false);
                animator.canvas.height = 500;
                animator.canvas.width = 800;
                animator.backgroundColor("#000");

                var fontObj = new V4.FontWrapper();
                await fontObj.loadFont(
                    "assets/CrimsonText-Regular.ttf",
                    "Crimson Text",
                    "Regular"
                );

                // var res = await fontObj.loadGFonts("Crimson Text", [
                //     "Regular",
                //     "Italic"
                // ]);

                var font = fontObj.getFontVariant("Regular");

                // var textBox = new V4.TextBox(font, 10, 300, 200, 150);
                // textBox.text("Hello, World!", 72);
                // textBox.outlinePath(true);
                // textBox.verticalAlign("CENTER");
                // textBox.horizontalAlign("CENTER");
                // animator.addToAnimation(textBox.renderer);
                const bounds = {
                    x1: 0,
                    y1: 250,
                    x2: 0,
                    y2: 0,
                    x3: 400,
                    y3: 0,
                    x4: 400,
                    y4: 250,
                    h: 250,
                    w: 400
                }
                var textBox2 = new V4.TextBox(font, bounds);
                textBox2.text("Here's a text!", 72);
                textBox2.outlinePath(true);
                textBox2.verticalAlign("TOP");
                textBox2.horizontalAlign("LEFT");

                function customRenderer(state) {
                    var ctx = state.context;
                    var bounds = textBox2.bounds()

                    textBox2.bounds(bounds.x * state.deltaTime, bounds.y, bounds.h, bounds.w)
                    textBox2.renderer(state);
                }
                animator.addToAnimation(customRenderer);

                animator.framesPerSecond(30);
                // var x = 0;
                // var right = true;
                // var speed = 20;

                // function backgroundRenderer(state) {
                //     right
                //         ? (x += speed * state.deltaTime)
                //         : (x -= speed * state.deltaTime);

                //     if (x + 100 > state.canvas.width) {
                //         right = false;
                //     } else if (x - 100 <= 0) {
                //         right = true;
                //     }

                //     state.context.fillStyle = "#000";
                //     state.context.fillRect(x, 20, 100, 200);
                //     //state.context.fillColor();

                //     //   let path = font.getPath("Hello, World!", x, 150, 72);
                //     // path.fill = "white";
                //     //  path.draw(animator.context);
                // }

                // animator.addToAnimation(backgroundRenderer);

                animator.startAnimationLoop();
            };

            start();
        </script>
    </body>
</html>
