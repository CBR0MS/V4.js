<html>
    <head>
        <meta charset="UTF-8" />
        <title>V4.js</title>
    </head>
    <body>
        <script src="https://cdn.jsdelivr.net/npm/opentype.js@latest/dist/opentype.min.js"></script>
        <script src="./V4.js"></script>
        <canvas id="testCanvas"></canvas>

        <script>
            var start = async function() {
                var canvas = document.getElementById("testCanvas");
                canvas.height = 500;
                canvas.width = 800;

                var loop = new V4.Loop(canvas, false);
                loop.backgroundColor("#fff");

                var fontObj = new V4.FontGroup();
                // await fontObj.loadFont(
                //     "assets/CrimsonText-Regular.ttf",
                //     "Regular"
                // );

                await fontObj.loadGFonts("Reas", ["Regular"]);

                // var res = await fontObj.loadGFonts("Crimson Text", [
                //     "Regular",
                //     "Italic"
                // ]);

                var font = fontObj.getFontVariant("Regular");
             

                // var textBox = new V4.TextBox(font, 10, 300, 200, 150);
                // textBox.text("Hello, World!", 72);
                // textBox.outlinePath(true);
                // textBox.verticalAlign("CENTER");
                // textBox.horizontalAlign("CENTER");
                // animator.addToAnimation(textBox.renderer);
                let bounds = {
                    x1: 0,
                    y1: 250,
                    x2: 0,
                    y2: 0,
                    x3: 400,
                    y3: 0,
                    x4: 400,
                    y4: 250,
                    h: 250,
                    w: 400
                }

                const options = {
                    bounds: bounds,
                    verticalAlign: "top",
                    horizontalAlign: "left",
                    fontSize: 72, 
                    color: "red",
                    strokeWidth: 2,
                    strokeColor: "white",

                }

                var textBox2 = new V4.TextBox({font: font, bounds: bounds, verticalAlign: "CENTER", horizontalAlign: "CENTER", fontSize: 72});
                textBox2.text("Here's a text!");
                textBox2.outlinePath(true);
                // textBox2.verticalAlign("TOP");
                // textBox2.horizontalAlign("LEFT");

               // var elapsed = 0;
               
                 var rq = new V4.RenderQueue();
                
                function colorLoop() {
                     var anim5 = new V4.Animation(textBox2, {color: "red", backgroundColor: "blue"});

                    rq.push(anim5.renderer, () => {

                        var anim6 = new V4.Animation(textBox2, {color: "yellow", backgroundColor: "green"});
                       
                        rq.push(anim6.renderer, () => {
                          
                            colorLoop()
                        })
                    })
                }

                
                function fontSizeLoop() {
                     var anim = new V4.Animation(textBox2, {fontSize: 72});

                    rq.push(anim.renderer, () => {

                        var anim2 = new V4.Animation(textBox2, {fontSize: 24});
                       
                        rq.push(anim2.renderer, () => {
                          
                            fontSizeLoop()
                        })
                    })
                }
                    
                function positionLoop() {

                     var anim3 = new V4.Animation(textBox2, {position: {x: 300, y: 450}}, 6, "easeInOutCubic")

                    rq.push(anim3.renderer, () => {

                        var anim4 = new V4.Animation(textBox2, {position: {x: 0, y: 250}}, 2, "easeInOutQuart")
                        rq.push(anim4.renderer, () => {
                          
                            positionLoop()
                        })
                    })
                }
                    
                    // rq.push(anim3.renderer, () => {
                    //     var anim4 = new V4.Animation(textBox2, {position: {x: 0, y: 250}});
                    //     rq.push(anim4.renderer, () => {

                    //     })
                    // })
                

                loop.addToLoop(rq);

                fontSizeLoop();
                positionLoop();
                colorLoop();

                // rq.push(anim.renderer, () => {
                //     rq.push(anim2.renderer, () => {

                //         anim = new V4.TextBoxAnim(textBox2, {x: 0, y:250}, {x:300, y:500}, 3, "easeInOutCubic")
                        
                //         rq.push(anim.renderer, () => {

                //             anim2 = new V4.TextBoxAnim(textBox2, {x:300, y:500}, {x: 0, y:250}, 3, "easeOutExpo")

                //             rq.push(anim2.renderer, () => {
                //                 loop.addToLoop(textBox2.renderer)
                //             })
                //         })
                //         //loop.addToLoop(textBox2.renderer)
                //     })
                // })

                // function customRenderer(state) {
                  
                //     // var ctx = state.context;
                //     // elapsed += state.deltaTime;
                //     // if (elapsed > 2) textBox2.text("Two seconds elapsed!", 24)
                //   // textBox2.bounds(bounds.x1 += 10 * state.deltaTime, bounds.y1, bounds.h, bounds.w)

                
                //     anim.move(state, () => {
                //        anim2.move(state, () => {
                        
                //        })
                //     })
                //    // textBox2.renderer(state);
                
                // }
                    


                
                //animator.addToAnimation(textBox2.renderer);
                loop.framesPerSecond(60);
                // var x = 0;
                // var right = true;
                // var speed = 20;

                // function backgroundRenderer(state) {
                //     right
                //         ? (x += speed * state.deltaTime)
                //         : (x -= speed * state.deltaTime);

                //     if (x + 100 > state.canvas.width) {
                //         right = false;
                //     } else if (x - 100 <= 0) {
                //         right = true;
                //     }

                //     state.context.fillStyle = "#000";
                //     state.context.fillRect(x, 20, 100, 200);
                //     //state.context.fillColor();

                //     //   let path = font.getPath("Hello, World!", x, 150, 72);
                //     // path.fill = "white";
                //     //  path.draw(animator.context);
                // }

                // animator.addToAnimation(backgroundRenderer);

                loop.startLoop();
            };

            start();
        </script>
    </body>
</html>
